<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<meta name="description" content="Javascript plugin for creating easily stylable select boxes with accessibility support">
	<title>Selection Box: Backbone examples</title>
	<link href='https://fonts.googleapis.com/css?family=Pacifico' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

	<link rel="stylesheet" href="css/reset.css"/>
	<link rel="stylesheet" href="css/website.css"/>
	<link rel="stylesheet" href="css/main.css"/>
	<link rel="stylesheet" href="css/simple.css"/>

	<script src="/lib/jquery.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.3.3/backbone-min.js"></script>
	<script src="/js/selection-box.js"></script>

</head>
<body>
<div class='banner' role='banner'>
	<h1><a href='/'>Selection Box</a></h1>
</div>
<div role='main' class='main'>
	<div id='gui'>
		<button class='add'>add</button>
		<button class='remove'>remove</button>
	</div>
	<h2>Backbone Example</h2>
	<p>
		SelectionBox works seamlessly with BackboneJS. Backbone Views can be used to render out dynamic
		HTML select elements whose options can change in response to changes in the backing Model or Collection.
		SelectionBox simply listens into the MutationEvents fired by the select element and re-renders itself
		accordingly.
	</p>
	<select id='alpha'></select>
	</div>
	<script>
	/*
		Backbone view model is a wrapped array
	*/

	var candidateCountries = [
		'Turkey', 'Russia', 'Iceland', 'Australia'
	];

	var Gui = Backbone.View.extend({
		events : {
			'click .add'    : 'addOption',
			'click .remove' : 'removeOption'
		},
		addOption : function () {
			this.collection.add({ country : candidateCountries.pop() });
		},
		removeOption : function () {
			var remove = this.collection.pop();
			console.log('removed', remove);
		}
	});

	var SelectView = Backbone.View.extend({
		initialize : function () {
			this.render();
			this.listenTo(this.collection, 'add remove', this.addRemoveOption);
		},
		addRemoveOption : function () {
			this.render();
		},
		createOption : function (opt) {
			var option = document.createElement('option');
			option.appendChild(document.createTextNode(opt.country));
			return option;
		},
		render : function () {
			var self = this;
			this.el.innerHTML = '';
			var frag = document.createDocumentFragment();
			this.collection.toJSON().forEach(function (option) {
				frag.appendChild(self.createOption(option));
			});
			this.el.appendChild(frag);
		}
	});

	var config = {
		hideFoundation : false  // show original select box
	}

	var countries = [
		{ country : 'Scotland'}, { country : 'England'}, { country : 'Ireland'}, { country :  'Wales'}
	];

	var collection = new Backbone.Collection(countries);

	new Gui({collection : collection, el : document.querySelector('#gui')});

	var selectView = new SelectView({  collection : collection, el : document.querySelector('#alpha') });

	var selectionBox = new SelectionBox(document.querySelector('#alpha'), config);

</script>

</body>
</html>